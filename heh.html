<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dragon Ball RP Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-deep: #07060a;
            --bg-mid: #0f1320;
            --card: #11121a;
            --muted: #bfc6d0;
            --accent-orange: #ff8a00;
            --accent-yellow: #ffd24d;
            --accent-blue: #00b7ff;
            --saiyan-red: #ff3131;
            --namekian-green: #2fb44f;
            --frieza-purple: #b270ff;
            --android-green: #8eff8a;
            --majin-pink: #ff77ff;
            --kai-pink: #ff88ff;
            --glass: rgba(255,255,255,0.04);
            --glass-border: rgba(255,255,255,0.04);
            --radius: 12px;
            --soft-shadow: 0 8px 30px rgba(2,6,23,0.6);
            --transition: 180ms cubic-bezier(.2,.9,.3,1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', sans-serif;
            background: var(--bg-deep);
            color: var(--muted);
            min-height: 100vh;
            background-image: 
                radial-gradient(1200px 600px at 10% 10%, rgba(255,138,0,0.06), transparent 10%),
                radial-gradient(900px 500px at 90% 80%, rgba(0,183,255,0.04), transparent 12%),
                linear-gradient(180deg, var(--bg-mid) 0%, var(--bg-deep) 60%);
            overflow-x: hidden;
            padding: 20px;
        }

        #app {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header & Navigation */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--glass-border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-pill {
            background: linear-gradient(90deg, var(--accent-orange), var(--accent-yellow));
            color: #111;
            font-weight: 700;
            padding: 8px 12px;
            border-radius: 999px;
            box-shadow: 0 6px 18px rgba(255,138,0,0.14);
            font-size: 0.92rem;
            letter-spacing: 0.7px;
        }

        .admin-badge {
            background: linear-gradient(90deg, var(--accent-blue), #0066ff);
            color: white;
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.8rem;
            margin-left: 10px;
            display: none;
        }

        nav {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 10px 16px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            color: var(--muted);
            font-family: 'Orbitron', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .nav-btn:hover, .nav-btn.active {
            background: linear-gradient(90deg, rgba(255,138,0,0.2), rgba(0,183,255,0.1));
            color: var(--accent-yellow);
            box-shadow: 0 0 15px rgba(255,138,0,0.1);
            border-color: rgba(255,138,0,0.3);
        }

        /* Main Content Area */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
            background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
            margin-bottom: 30px;
        }

        .page.active {
            display: block;
        }

        .page-header {
            margin-bottom: 25px;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--glass-border);
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--accent-yellow);
            text-shadow: 0 6px 18px rgba(255,138,0,0.06);
        }

        .page-subtitle {
            color: var(--muted);
            font-size: 16px;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Dashboard */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.6);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
            color: var(--accent-orange);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--accent-yellow);
        }

        .stat-label {
            color: var(--muted);
            font-size: 14px;
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .card {
            background: var(--card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.6);
        }

        .card-header {
            padding: 15px 20px;
            background: linear-gradient(90deg, rgba(255,138,0,0.1), rgba(0,183,255,0.05));
            color: var(--accent-orange);
            font-weight: 700;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-body {
            padding: 20px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--accent-blue);
            font-size: 0.9rem;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px 12px;
            background: transparent;
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            color: var(--muted);
            font-family: 'Orbitron', sans-serif;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px rgba(0,183,255,0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            color: var(--muted);
            font-family: 'Orbitron', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: linear-gradient(90deg, var(--accent-orange), var(--accent-yellow));
            color: #111;
            border: none;
            font-weight: 700;
        }

        .btn-success {
            background: linear-gradient(90deg, #00cc7a, #00b36b);
            color: white;
            border: none;
        }

        .btn-danger {
            background: linear-gradient(90deg, var(--saiyan-red), #cc0000);
            color: white;
            border: none;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.8rem;
        }

        /* Tables */
        .table-container {
            background: var(--card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
            margin-bottom: 25px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--glass-border);
            font-size: 0.9rem;
        }

        th {
            background: rgba(0,0,0,0.2);
            font-weight: 600;
            color: var(--accent-blue);
        }

        tr:hover {
            background: rgba(255,255,255,0.03);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding: 30px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(to bottom, var(--accent-orange), var(--accent-blue));
            transform: translateX(-50%);
        }

        .timeline-item {
            width: 50%;
            padding: 20px 40px;
            position: relative;
        }

        .timeline-item:nth-child(odd) {
            left: 0;
            padding-right: 60px;
        }

        .timeline-item:nth-child(even) {
            left: 50%;
            padding-left: 60px;
        }

        .timeline-content {
            background: var(--card);
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
            position: relative;
        }

        .timeline-content::before {
            content: '';
            position: absolute;
            top: 30px;
            width: 30px;
            height: 3px;
            background: linear-gradient(to right, var(--accent-orange), transparent);
        }

        .timeline-item:nth-child(odd) .timeline-content::before {
            right: -30px;
        }

        .timeline-item:nth-child(even) .timeline-content::before {
            left: -30px;
            background: linear-gradient(to left, var(--accent-orange), transparent);
        }

        .timeline-date {
            font-weight: 700;
            color: var(--accent-orange);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .timeline-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--accent-yellow);
        }

        .timeline-desc {
            font-size: 0.9rem;
            color: var(--muted);
        }

        /* OC Sheet */
        .sheet-header {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 15px;
        }

        .sheet-title {
            margin: 0;
            font-size: 1.2rem;
            color: var(--accent-yellow);
            text-shadow: 0 6px 18px rgba(255,138,0,0.06);
        }

        .section {
            margin-bottom: 15px;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.02);
            background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
        }

        .section-head {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 8px 12px;
            background: linear-gradient(90deg, rgba(255,138,0,0.06), rgba(0,183,255,0.03));
            cursor: pointer;
            transition: box-shadow 200ms;
        }

        .section-head:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.5), 0 0 18px rgba(0,183,255,0.02);
        }

        .section-head h2 {
            margin: 0;
            font-size: 0.98rem;
            color: var(--accent-orange);
            letter-spacing: 0.6px;
        }

        .section-body {
            padding: 12px;
            border-top: 1px solid rgba(255,255,255,0.02);
            transition: max-height var(--transition), opacity var(--transition);
            overflow: hidden;
        }

        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .field {
            margin-bottom: 8px;
        }

        /* Relationship Tree */
        .tree-container {
            background: var(--card);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
            overflow: auto;
            min-height: 400px;
            display: flex;
            justify-content: center;
        }

        .tree {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .tree-node {
            background: linear-gradient(90deg, var(--accent-orange), var(--accent-yellow));
            color: #111;
            padding: 12px 18px;
            border-radius: var(--radius);
            margin: 10px;
            min-width: 180px;
            text-align: center;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            font-weight: 700;
        }

        .tree-relation {
            font-size: 0.8rem;
            color: var(--accent-blue);
            margin-top: 5px;
            font-style: italic;
        }

        .tree-children {
            display: flex;
            gap: 20px;
            position: relative;
            margin-top: 20px;
        }

        /* Worldview */
        .planet-grid {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 25px;
        }

        .planet {
            width: 140px;
            text-align: center;
            cursor: pointer;
        }

        .planet img {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 3px solid rgba(255,165,0,0.9);
            box-shadow: 0 0 20px rgba(255,165,0,0.12);
            display: block;
            margin: 0 auto 6px;
            object-fit: cover;
            transition: transform 220ms ease, box-shadow 220ms ease;
        }

        .planet:hover img {
            transform: scale(1.06);
            box-shadow: 0 0 42px rgba(0,183,255,0.14);
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--card);
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 1px solid var(--glass-border);
            animation: scaleIn 0.3s ease;
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(90deg, var(--accent-orange), var(--accent-yellow));
            color: #111;
            font-weight: 700;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            color: #111;
            font-size: 20px;
            cursor: pointer;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Utility Classes */
        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .d-flex {
            display: flex;
        }

        .align-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-10 {
            gap: 10px;
        }

        .gap-20 {
            gap: 20px;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .badge-primary {
            background: var(--accent-orange);
            color: #111;
        }

        .badge-success {
            background: #00cc7a;
            color: white;
        }

        .badge-warning {
            background: var(--accent-yellow);
            color: #111;
        }

        .badge-danger {
            background: var(--saiyan-red);
            color: white;
        }

        .admin-only {
            display: none;
        }

        .admin-mode .admin-only {
            display: block;
        }

        .admin-mode .editable {
            border: 1px dashed rgba(255,138,0,0.5);
            padding: 5px;
            border-radius: 4px;
            cursor: text;
        }

        /* OC Sheet Specific Styles */
        .oc-sheet-container {
            display: grid;
            grid-template-columns: 1fr 360px;
            gap: 24px;
            align-items: start;
        }

        .oc-content {
            background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
            border-radius: var(--radius);
            padding: 18px;
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
        }

        .oc-infopanel {
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border-radius: var(--radius);
            padding: 18px;
            box-shadow: 0 18px 40px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.03);
            position: sticky;
            top: 24px;
            height: fit-content;
            outline: 2px solid rgba(0,183,255,0.03);
        }

        .oc-section {
            margin-bottom: 14px;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.02);
            background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
        }

        .oc-section .section-head {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 8px 12px;
            background: linear-gradient(90deg, rgba(255,138,0,0.06), rgba(0,183,255,0.03));
            cursor: pointer;
            transition: box-shadow 200ms;
        }

        .oc-section .section-head:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.5), 0 0 18px rgba(0,183,255,0.02);
        }

        .oc-section .section-head h2 {
            margin: 0;
            font-size: 0.98rem;
            color: var(--accent-orange);
            letter-spacing: 0.6px;
        }

        .oc-section .section-body {
            padding: 12px;
            border-top: 1px solid rgba(255,255,255,0.02);
            transition: max-height var(--transition), opacity var(--transition);
            overflow: hidden;
        }

        .oc-section.collapsed .section-body {
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
        }

        .oc-section.expanded .section-body {
            max-height: 1200px;
            opacity: 1;
        }

        .label {
            font-size: 0.78rem;
            color: var(--accent-blue);
            margin-bottom: 6px;
            display: block;
        }

        .oc-input, .oc-textarea, .oc-select {
            width: 100%;
            background: transparent;
            color: var(--muted);
            border: 1px solid rgba(255,255,255,0.04);
            padding: 8px 10px;
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.9rem;
            transition: box-shadow var(--transition), border-color var(--transition), transform 100ms;
        }

        .oc-textarea {
            min-height: 72px;
            resize: vertical;
        }

        .oc-input:focus, .oc-textarea:focus, .oc-select:focus {
            box-shadow: 0 6px 20px rgba(0,183,255,0.08);
            border-color: rgba(0,183,255,0.22);
            transform: translateY(-2px);
            outline: none;
        }

        .dynamic-list {
            margin-top: 8px;
        }

        .entry {
            background: linear-gradient(180deg, rgba(255,255,255,0.012), transparent);
            border: 1px solid rgba(0,183,255,0.06);
            border-radius: 10px;
            padding: 8px;
            margin-bottom: 10px;
            display: flex;
            gap: 10px;
            align-items: flex-start;
            transition: box-shadow 140ms, transform 140ms;
        }

        .entry-number {
            font-weight: 700;
            color: var(--accent-yellow);
            width: 36px;
            text-align: center;
            flex-shrink: 0;
            margin-top: 6px;
            font-size: 0.95rem;
        }

        .entry-img-wrap {
            width: 84px;
            height: 84px;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid rgba(255,138,0,0.14);
            box-shadow: 0 6px 18px rgba(255,138,0,0.04) inset;
            flex-shrink: 0;
            cursor: pointer;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .entry-img-wrap img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .entry .file-input {
            display: none;
        }

        .entry-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .entry-content input[type="text"], .entry-content textarea {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.03);
            color: var(--muted);
            padding: 8px;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .entry .remove-btn {
            background: none;
            border: none;
            color: var(--saiyan-red);
            font-size: 1.1rem;
            cursor: pointer;
            align-self: center;
            padding: 6px 8px;
        }

        .color-row {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .entry:hover {
            box-shadow: 0 18px 40px rgba(0,0,0,0.6), 0 0 28px rgba(0,183,255,0.03);
            transform: translateY(-4px);
        }

        .pl-portrait {
            width: 96px;
            height: 96px;
            border-radius: 8px;
            overflow: hidden;
            background: #0b0b0f;
            border: 3px solid rgba(255,165,0,0.9);
            display: block;
            margin-top: 8px;
            transition: box-shadow 220ms, transform 220ms;
        }

        .pl-portrait img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* Power Level Portrait Styles */
        .portrait-container {
            position: relative;
            width: 96px;
            height: 96px;
            margin-top: 10px;
        }

        .portrait-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            border: 3px solid rgba(255, 165, 0, 0.9);
            box-shadow: 0 0 20px currentColor;
        }

        .portrait-aura {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
            opacity: 0.5;
            mix-blend-mode: overlay;
            animation: auraGlow 2s infinite alternate;
        }

        @keyframes auraGlow {
            from { box-shadow: 0 0 10px currentColor; }
            to { box-shadow: 0 0 25px currentColor; }
        }

        .portrait-info {
            margin-top: 8px;
            text-align: center;
        }

        .portrait-name {
            font-weight: bold;
            color: var(--accent-yellow);
            font-size: 0.9rem;
        }

        .portrait-range {
            font-size: 0.75rem;
            color: var(--muted);
        }

        /* Relationship Editor */
        .relationship-editor {
            background: var(--card);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--soft-shadow);
            border: 1px solid var(--glass-border);
            margin-bottom: 20px;
        }

        .relation-form {
            display: grid;
            grid-template-columns: 1fr 1fr 120px;
            gap: 10px;
            margin-bottom: 15px;
        }

        /* OC Image Viewer */
        .oc-image-viewer {
            width: 100%;
            height: 200px;
            border-radius: var(--radius);
            overflow: hidden;
            margin-bottom: 15px;
            border: 2px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .oc-image-viewer:hover {
            border-color: var(--accent-orange);
            box-shadow: 0 0 20px rgba(255,138,0,0.3);
        }

        .oc-image-viewer img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .oc-image-placeholder {
            color: var(--muted);
            text-align: center;
            padding: 20px;
        }

        /* Bulk Delete Controls */
        .bulk-controls {
            background: var(--card);
            border-radius: var(--radius);
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Checkbox for bulk selection */
        .bulk-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .cards-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .timeline::before {
                left: 30px;
            }
            
            .timeline-item {
                width: 100%;
                padding-left: 70px;
                padding-right: 20px;
            }
            
            .timeline-item:nth-child(even) {
                left: 0;
            }
            
            .timeline-content::before {
                left: -30px !important;
                background: linear-gradient(to left, var(--accent-orange), transparent) !important;
            }

            .oc-sheet-container {
                grid-template-columns: 1fr;
            }

            .oc-infopanel {
                position: relative;
                top: auto;
            }
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            nav {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .cards-grid {
                grid-template-columns: 1fr;
            }
            
            .two-col {
                grid-template-columns: 1fr;
            }

            .relation-form {
                grid-template-columns: 1fr;
            }
        }

        /* Colorful enhancements */
        .saiyan-bg {
            background: linear-gradient(135deg, rgba(255,138,0,0.1), rgba(255,210,77,0.05));
        }

        .namekian-bg {
            background: linear-gradient(135deg, rgba(47,180,79,0.1), rgba(47,180,79,0.05));
        }

        .frieza-bg {
            background: linear-gradient(135deg, rgba(178,112,255,0.1), rgba(178,112,255,0.05));
        }

        .android-bg {
            background: linear-gradient(135deg, rgba(142,255,138,0.1), rgba(142,255,138,0.05));
        }

        .majin-bg {
            background: linear-gradient(135deg, rgba(255,119,255,0.1), rgba(255,119,255,0.05));
        }

        .kai-bg {
            background: linear-gradient(135deg, rgba(255,136,255,0.1), rgba(255,136,255,0.05));
        }

        .color-glow {
            box-shadow: 0 0 15px currentColor;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .race-saiyan { color: var(--accent-yellow); }
        .race-namekian { color: var(--namekian-green); }
        .race-frieza { color: var(--frieza-purple); }
        .race-android { color: var(--android-green); }
        .race-majin { color: var(--majin-pink); }
        .race-kai { color: var(--kai-pink); }
        .race-human { color: var(--accent-blue); }
        .race-other { color: var(--muted); }
    </style>
</head>
<body>
    <div id="app">
        <header>
            <div class="logo">
                <div class="logo-pill">DRAGON BALL RP HUB</div>
                <div id="adminBadge" class="admin-badge">ADMIN MODE</div>
            </div>
            <nav>
                <button class="nav-btn active" data-page="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </button>
                <button class="nav-btn" data-page="oc-sheet">
                    <i class="fas fa-file-alt"></i> OC Sheet
                </button>
                <button class="nav-btn" data-page="worldview">
                    <i class="fas fa-globe"></i> Worldview
                </button>
                <button class="nav-btn" data-page="timeline">
                    <i class="fas fa-history"></i> Timeline
                </button>
                <button class="nav-btn" data-page="relationships">
                    <i class="fas fa-code-branch"></i> Relationships
                </button>
                <button id="manageOcsBtn" class="nav-btn admin-only" data-page="manage">
                    <i class="fas fa-users-cog"></i> Manage OCs
                </button>
                <button id="adminLoginBtn" class="nav-btn">
                    <i class="fas fa-lock"></i> Admin Login
                </button>
            </nav>
        </header>

        <main>
            <!-- Dashboard Page -->
            <section id="dashboard" class="page active">
                <div class="page-header">
                    <h1 class="page-title">Server Dashboard</h1>
                    <p class="page-subtitle">Welcome to your Dragon Ball RP server management hub</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value">42</div>
                        <div class="stat-label">Total OCs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="stat-value">28</div>
                        <div class="stat-label">Approved OCs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-clock"></i>
                        </div>
                        <div class="stat-value">14</div>
                        <div class="stat-label">Pending Approval</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-value">7</div>
                        <div class="stat-label">Current Arcs</div>
                    </div>
                </div>

                <div class="cards-grid">
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-plus-circle"></i> Create New OC
                        </div>
                        <div class="card-body">
                            <p>Create a new Original Character for the Dragon Ball RP universe.</p>
                            <button class="btn btn-primary mt-20" onclick="showModal('create-oc-modal')">
                                <i class="fas fa-plus"></i> New Character
                            </button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-tasks"></i> Pending Approvals
                        </div>
                        <div class="card-body">
                            <p>You have 14 OCs waiting for your approval.</p>
                            <button class="btn btn-primary mt-20" onclick="showPage('manage')">
                                <i class="fas fa-clipboard-check"></i> Review OCs
                            </button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <i class="fas fa-chart-line"></i> Server Activity
                        </div>
                        <div class="card-body">
                            <p>View server statistics and activity reports.</p>
                            <button class="btn btn-primary mt-20">
                                <i class="fas fa-chart-bar"></i> View Reports
                            </button>
                        </div>
                    </div>
                </div>

                <div class="table-container mt-20">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Race</th>
                                <th>Power Level</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Kairo</td>
                                <td class="race-saiyan">Saiyan</td>
                                <td>85,000</td>
                                <td><span class="badge badge-success">Approved</span></td>
                                <td>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Zyla</td>
                                <td class="race-namekian">Namekian</td>
                                <td>42,000</td>
                                <td><span class="badge badge-success">Approved</span></td>
                                <td>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Vex</td>
                                <td class="race-frieza">Frieza Race</td>
                                <td>120,000</td>
                                <td><span class="badge badge-warning">Pending</span></td>
                                <td>
                                    <button class="btn btn-sm btn-success" onclick="approveOC(2)"><i class="fas fa-check"></i></button>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(2)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td>Cyra</td>
                                <td class="race-android">Android</td>
                                <td>95,000</td>
                                <td><span class="badge badge-success">Approved</span></td>
                                <td>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(3)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- OC Sheet Page -->
            <section id="oc-sheet" class="page">
                <div class="page-header">
                    <h1 class="page-title">OC Character Sheet</h1>
                    <p class="page-subtitle">Create and manage your Original Character</p>
                </div>

                <div class="oc-sheet-container">
                    <section class="oc-content" aria-labelledby="sheetTitle">
                        <div class="sheet-header">
                            <div class="logo-pill">DRAGON BALL — OC SHEET</div>
                            <div id="sheetTitle" class="sheet-title editable" contenteditable="true" tabindex="0" role="textbox" aria-label="Character tagline" data-placeholder="Character Quote / Tagline — (click to edit)">Character Quote / Tagline — (click to edit)</div>
                        </div>

                        <div style="display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap">
                            <button class="btn" onclick="toggleAllSections(true)">
                                <i class="fas fa-expand"></i> Expand All
                            </button>
                            <button class="btn" onclick="toggleAllSections(false)">
                                <i class="fas fa-compress"></i> Collapse All
                            </button>
                            <button class="btn btn-primary" onclick="downloadJSON()">
                                <i class="fas fa-download"></i> Export JSON
                            </button>
                            <button class="btn" onclick="saveOCToCollection()">
                                <i class="fas fa-save"></i> Save OC
                            </button>
                            <button id="clearBtn" class="btn" onclick="clearAll()" title="Clear all sheet fields">
                                <i class="fas fa-trash"></i> Clear All
                            </button>
                        </div>

                        <!-- Backstory -->
                        <article class="oc-section expanded" id="sec-backstory">
                            <div class="section-head" onclick="toggleSection(this)"><h2>Backstory</h2><div class="meta">▼</div></div>
                            <div class="section-body">
                                <div class="field"><label class="label">Short summary</label><textarea id="backstory_short" class="oc-textarea" placeholder="Short summary or hook..."></textarea></div>
                                <div class="field"><label class="label">Full backstory</label><textarea id="backstory_full" class="oc-textarea" placeholder="Detailed backstory..."></textarea></div>
                            </div>
                        </article>

                        <!-- Personality -->
                        <article class="oc-section expanded" id="sec-personality">
                            <div class="section-head" onclick="toggleSection(this)"><h2>Personality</h2><div class="meta">▼</div></div>
                            <div class="section-body">
                                <div class="two-col">
                                    <div>
                                        <div class="field"><label class="label">Traits</label><textarea id="traits" class="oc-textarea" placeholder="Key personality traits..."></textarea></div>
                                        <div class="field"><label class="label">Likes</label><textarea id="likes" class="oc-textarea" placeholder="Favorites, foods, hobbies..."></textarea></div>
                                    </div>
                                    <div>
                                        <div class="field"><label class="label">Fears/Weaknesses</label><textarea id="fears" class="oc-textarea" placeholder="Fears, psychological weaknesses..."></textarea></div>
                                        <div class="field"><label class="label">Goals / Dreams</label><textarea id="goals" class="oc-textarea" placeholder="Long term goals..."></textarea></div>
                                    </div>
                                </div>
                            </div>
                        </article>

                        <!-- Abilities & Techniques -->
                        <article class="oc-section expanded" id="sec-abilities">
                            <div class="section-head" onclick="toggleSection(this)"><h2>Abilities & Techniques</h2><div class="meta">▼</div></div>
                            <div class="section-body">
                                <div class="field">
                                    <label class="label">Signature Abilities</label>
                                    <div id="abilitiesList" class="dynamic-list"></div>
                                    <div style="margin-top:8px"><button class="btn" onclick="addEntry('abilitiesList')">+ Add Ability</button></div>
                                </div>
                                <div class="field" style="margin-top:8px">
                                    <label class="label">Techniques</label>
                                    <div id="techniquesList" class="dynamic-list"></div>
                                    <div style="margin-top:8px"><button class="btn" onclick="addEntry('techniquesList')">+ Add Technique</button></div>
                                </div>
                            </div>
                        </article>

                        <!-- Transformations -->
                        <article class="oc-section expanded" id="sec-transforms">
                            <div class="section-head" onclick="toggleSection(this)"><h2>Transformations</h2><div class="meta">▼</div></div>
                            <div class="section-body">
                                <div id="transformsList" class="dynamic-list"></div>
                                <div style="margin-top:8px"><button class="btn" onclick="addEntry('transformsList','transform')">+ Add Transformation</button></div>
                            </div>
                        </article>

                        <!-- Equipment -->
                        <article class="oc-section expanded" id="sec-equipment">
                            <div class="section-head" onclick="toggleSection(this)"><h2>Equipment</h2><div class="meta">▼</div></div>
                            <div class="section-body">
                                <div id="equipmentList" class="dynamic-list"></div>
                                <div style="margin-top:8px"><button class="btn" onclick="addEntry('equipmentList')">+ Add Equipment</button></div>
                            </div>
                        </article>

                        <!-- Notable Battles -->
                        <article class="oc-section expanded" id="sec-battles">
                            <div class="section-head" onclick="toggleSection(this)"><h2>Notable Battles / Events</h2><div class="meta">▼</div></div>
                            <div class="section-body">
                                <div class="field"><label class="label">Battles</label><textarea id="battles" class="oc-textarea" placeholder="Descriptions and outcomes..."></textarea></div>
                            </div>
                        </article>
                    </section>

                    <!-- RIGHT INFO PANEL -->
                    <aside class="oc-infopanel" aria-labelledby="infoTitle" id="infoPanel">
                        <div class="info-header">
                            <div style="flex:1">
                                <div style="display:flex;gap:8px;align-items:center;">
                                    <div style="flex:1">
                                        <div style="display:flex;gap:8px;align-items:center">
                                            <div style="flex:1">
                                                <input id="ocName" type="text" class="oc-input" placeholder="OC Name" style="font-size:1.06rem;font-weight:700" />
                                            </div>
                                            <button class="btn" onclick="fillExample()" title="Fill example">Example</button>
                                        </div>
                                        <div style="margin-top:8px"><input id="ocAlias" type="text" class="oc-input" placeholder="Alias / Title (optional)" /></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- OC Image Display -->
                        <div style="margin-bottom:10px">
                            <label class="label">Portrait / Poster</label>
                            <div id="ocImageViewer" class="oc-image-viewer" onclick="showModal('oc-image-modal')">
                                <div id="poster" class="poster" tabindex="0" role="img" aria-label="OC portrait" style="background-size:cover;background-position:center;border-radius:8px;height:240px;border:1px dashed rgba(255,255,255,0.03);background-image:none;cursor:pointer;width:100%;"></div>
                                <div id="imagePlaceholder" class="oc-image-placeholder">
                                    <i class="fas fa-image" style="font-size: 2rem; margin-bottom: 10px;"></i>
                                    <p>Click to upload an image</p>
                                </div>
                            </div>
                            <input id="posterFile" type="file" accept="image/*" style="margin-top:8px" />
                        </div>

                        <div class="scouter" title="Power level">
                            <div>
                                <div class="label">Power Level</div>
                                <div style="display:flex;gap:8px;align-items:center">
                                    <input id="powerInput" class="oc-input" type="number" placeholder="e.g. 9000" />
                                    <button class="btn" onclick="readPower()" title="Scan">Scan</button>
                                </div>
                            </div>
                            <div style="text-align:right">
                                <div class="pl" id="plValue">—</div>
                                <div class="cat" id="plCategory">—</div>
                            </div>

                            <!-- PL portrait + aura -->
                            <div class="portrait-container" id="plPortraitWrap">
                                <img id="plPortraitImg" class="portrait-image" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDk2IDk2Ij48cmVjdCB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIGZpbGw9IiMwZTBlMTUiIHJ4PSI4Ii8+PHRleHQgeD0iNDgiIHk9IjUwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiNmZmYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPlBvd2VyIExldmVsIFBvcnRyYWl0PC90ZXh0Pjwvc3ZnPg==" alt="PL Portrait" />
                                <div class="portrait-aura" id="plPortraitAura"></div>
                            </div>
                            <div class="portrait-info">
                                <div class="portrait-name" id="plPortraitName">—</div>
                                <div class="portrait-range" id="plPortraitRange">—</div>
                            </div>
                        </div>

                        <div class="infobox" aria-hidden="false" style="margin-top:12px">
                            <div class="field"><label class="label">Race</label>
                                <select id="raceSelect" class="oc-select">
                                    <option value="">Select...</option>
                                    <option>Saiyan</option>
                                    <option>Namekian</option>
                                    <option>Frieza Race</option>
                                    <option>Human</option>
                                    <option>Android</option>
                                    <option>Majin</option>
                                    <option>Kai</option>
                                    <option>Other</option>
                                </select>
                            </div>
                            <div class="field"><label class="label">Universe</label><input id="universe" class="oc-input" placeholder="Universe 7" /></div>
                            <div class="field"><label class="label">Home Planet</label><input id="homeplanet" class="oc-input" placeholder="e.g. Planet Vegeta" /></div>
                            <div class="field"><label class="label">Age</label><input id="age" class="oc-input" /></div>
                            <div class="field"><label class="label">Height</label><input id="height" class="oc-input" placeholder="cm / ft" /></div>
                            <div class="field"><label class="label">Weight</label><input id="weight" class="oc-input" placeholder="kg / lb" /></div>
                            <div class="field"><label class="label">Eye Color</label><input id="eyecolor" class="oc-input" /></div>
                            <div class="field"><label class="label">Hair Color</label><input id="haircolor" class="oc-input" /></div>
                            <div class="field"><label class="label">Blood Type</label><input id="blood" class="oc-input" /></div>
                            <div class="field"><label class="label">Occupations / Affiliations</label><input id="affils" class="oc-input" placeholder="Z-Fighters, Frieza Force" /></div>
                        </div>
                    </aside>
                </div>
            </section>

            <!-- Worldview Page -->
            <section id="worldview" class="page">
                <div class="page-header">
                    <h1 class="page-title">Worldview</h1>
                    <p class="page-subtitle">Explore the planets and OCs in your Dragon Ball universe</p>
                </div>

                <div class="planet-grid">
                    <div class="planet">
                        <img src="https://static.wikia.nocookie.net/dragonball/images/3/36/Planet_Sadala.png/revision/latest/scale-to-width-down/300?cb=20181125012120" alt="Sadala">
                        <div>Sadala</div>
                    </div>
                    <div class="planet">
                        <img src="https://static.wikia.nocookie.net/dragonball/images/0/0c/Yardrat.png/revision/latest/scale-to-width-down/300?cb=20181125012120" alt="Yardrat">
                        <div>Yardrat</div>
                    </div>
                    <div class="planet">
                        <img src="https://static.wikia.nocookie.net/dragonball/images/6/6a/King_Kai%27s_Planet.png/revision/latest/scale-to-width-down/300?cb=20181125012120" alt="King Kai's Planet">
                        <div>King Kai's Planet</div>
                    </div>
                    <div class="planet">
                        <img src="https://static.wikia.nocookie.net/dragonball/images/9/9e/New_Namek.png/revision/latest/scale-to-width-down/300?cb=20181125012120" alt="New Namek">
                        <div>New Namek</div>
                    </div>
                    <div class="planet">
                        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'><defs><radialGradient id='g' cx='30%' cy='30%'><stop offset='0' stop-color='%234aa3ff'/><stop offset='1' stop-color='%230b3a6b'/></radialGradient></defs><rect width='100%' height='100%' rx='999' fill='%23051021'/><circle cx='60' cy='60' r='50' fill='url(%23g)' stroke='%23d4f0ff' stroke-opacity='0.06' stroke-width='2'/></svg>" alt="Earth">
                        <div>Earth</div>
                    </div>
                    <div class="planet">
                        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120'><rect width='100%' height='100%' rx='999' fill='%2308020a'/><circle cx='60' cy='60' r='50' fill='%236b0000' stroke='%23ffb075' stroke-opacity='0.08' stroke-width='2'/></svg>" alt="Planet Vegeta">
                        <div>Planet Vegeta</div>
                    </div>
                </div>

                <div class="table-container mt-20">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Race</th>
                                <th>Planet</th>
                                <th>Power Level</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Kairo</td>
                                <td class="race-saiyan">Saiyan</td>
                                <td>Planet Vegeta</td>
                                <td>85,000</td>
                                <td><span class="badge badge-success">Active</span></td>
                            </tr>
                            <tr>
                                <td>Zyla</td>
                                <td class="race-namekian">Namekian</td>
                                <td>New Namek</td>
                                <td>42,000</td>
                                <td><span class="badge badge-success">Active</span></td>
                            </tr>
                            <tr>
                                <td>Vex</td>
                                <td class="race-frieza">Frieza Race</td>
                                <td>Planet Frieza #79</td>
                                <td>120,000</td>
                                <td><span class="badge badge-warning">Traveling</span></td>
                            </tr>
                            <tr>
                                <td>Cyra</td>
                                <td class="race-android">Android</td>
                                <td>Earth</td>
                                <td>95,000</td>
                                <td><span class="badge badge-success">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Timeline Page -->
            <section id="timeline" class="page">
                <div class="page-header">
                    <h1 class="page-title">RP Timeline</h1>
                    <p class="page-subtitle">The history and major events of your Dragon Ball RP universe</p>
                    <button id="addEventBtn" class="btn btn-primary admin-only" onclick="showModal('edit-timeline-modal')">
                        <i class="fas fa-plus"></i> Add Event
                    </button>
                </div>

                <div class="timeline" id="timelineContainer">
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <div class="timeline-date">
                                <i class="fas fa-calendar-alt"></i> Age 761
                                <div class="admin-only">
                                    <button class="btn btn-sm" onclick="editTimelineEvent(0)"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteTimelineEvent(0)"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <h3 class="timeline-title">The Saiyan Exodus</h3>
                            <p class="timeline-desc">A group of Saiyans escapes Planet Vegeta's destruction and finds refuge in Universe 6.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <div class="timeline-date">
                                <i class="fas fa-calendar-alt"></i> Age 774
                                <div class="admin-only">
                                    <button class="btn btn-sm" onclick="editTimelineEvent(1)"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteTimelineEvent(1)"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <h3 class="timeline-title">The Galactic Conflict</h3>
                            <p class="timeline-desc">War breaks out between the Frieza Force and a rebellion led by surviving Saiyans.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <div class="timeline-date">
                                <i class="fas fa-calendar-alt"></i> Age 780
                                <div class="admin-only">
                                    <button class="btn btn-sm" onclick="editTimelineEvent(2)"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteTimelineEvent(2)"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <h3 class="timeline-title">The New Namekian Era</h3>
                            <p class="timeline-desc">Namekians discover a new way to fuse, creating powerful warriors to protect their planet.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <div class="timeline-date">
                                <i class="fas fa-calendar-alt"></i> Age 785
                                <div class="admin-only">
                                    <button class="btn btn-sm" onclick="editTimelineEvent(3)"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteTimelineEvent(3)"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <h3 class="timeline-title">The Android Uprising</h3>
                            <p class="timeline-desc">A new generation of androids becomes self-aware and seeks independence.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <div class="timeline-date">
                                <i class="fas fa-calendar-alt"></i> Present Day
                                <div class="admin-only">
                                    <button class="btn btn-sm" onclick="editTimelineEvent(4)"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteTimelineEvent(4)"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <h3 class="timeline-title">The Multiversal Tournament</h3>
                            <p class="timeline-desc">Zeno announces a tournament that will include fighters from all universes.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Relationships Page -->
            <section id="relationships" class="page">
                <div class="page-header">
                    <h1 class="page-title">Character Relationships</h1>
                    <p class="page-subtitle">Visualize the connections between characters in your RP universe</p>
                    <button id="editRelationsBtn" class="btn btn-primary admin-only" onclick="showModal('edit-relations-modal')">
                        <i class="fas fa-edit"></i> Edit Relationships
                    </button>
                </div>

                <div class="relationship-editor admin-only">
                    <h3>Add Relationship</h3>
                    <div class="relation-form">
                        <select id="relationChar1" class="form-select">
                            <option value="">Select Character 1</option>
                            <option value="Kairo">Kairo</option>
                            <option value="Zyla">Zyla</option>
                            <option value="Vex">Vex</option>
                            <option value="Cyra">Cyra</option>
                        </select>
                        <select id="relationType" class="form-select">
                            <option value="Ally">Ally</option>
                            <option value="Rival">Rival</option>
                            <option value="Mentor">Mentor</option>
                            <option value="Student">Student</option>
                            <option value="Family">Family</option>
                            <option value="Friend">Friend</option>
                            <option value="Enemy">Enemy</option>
                        </select>
                        <select id="relationChar2" class="form-select">
                            <option value="">Select Character 2</option>
                            <option value="Kairo">Kairo</option>
                            <option value="Zyla">Zyla</option>
                            <option value="Vex">Vex</option>
                            <option value="Cyra">Cyra</option>
                        </select>
                        <button class="btn btn-primary" onclick="addRelationship()">Add Relationship</button>
                    </div>
                </div>

                <div class="tree-container">
                    <div class="tree" id="relationshipTree">
                        <div class="tree-node">Kairo (Saiyan)</div>
                        <div class="tree-children">
                            <div class="tree">
                                <div class="tree-node">Zyla (Namekian)
                                    <div class="tree-relation">Ally</div>
                                    <button class="btn btn-sm btn-danger admin-only" onclick="deleteRelationship('Kairo', 'Zyla')"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <div class="tree">
                                <div class="tree-node">Vex (Frieza Race)
                                    <div class="tree-relation">Rival</div>
                                    <button class="btn btn-sm btn-danger admin-only" onclick="deleteRelationship('Kairo', 'Vex')"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <div class="tree">
                                <div class="tree-node">Cyra (Android)
                                    <div class="tree-relation">Mentor</div>
                                    <button class="btn btn-sm btn-danger admin-only" onclick="deleteRelationship('Kairo', 'Cyra')"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="text-center mt-20">
                    <button class="btn btn-primary" onclick="generateRelationshipMap()">
                        <i class="fas fa-sitemap"></i> Generate Full Relationship Map
                    </button>
                </div>
            </section>

            <!-- Manage OCs Page -->
            <section id="manage" class="page admin-only">
                <div class="page-header">
                    <h1 class="page-title">OC Management</h1>
                    <p class="page-subtitle">Approve, edit, or remove Original Characters from your RP server</p>
                </div>

                <div class="bulk-controls admin-only">
                    <input type="checkbox" id="selectAll" class="bulk-checkbox" onchange="toggleSelectAll(this)">
                    <label for="selectAll">Select All</label>
                    <button class="btn btn-danger" onclick="bulkDeleteOCs()">
                        <i class="fas fa-trash"></i> Delete Selected
                    </button>
                    <button class="btn btn-success" onclick="bulkApproveOCs()">
                        <i class="fas fa-check"></i> Approve Selected
                    </button>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th></th>
                                <th>Name</th>
                                <th>Race</th>
                                <th>Creator</th>
                                <th>Power Level</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="manageOcTable">
                            <tr>
                                <td><input type="checkbox" class="bulk-checkbox oc-checkbox" data-id="0"></td>
                                <td>Kairo</td>
                                <td class="race-saiyan">Saiyan</td>
                                <td>@DragonFan92</td>
                                <td>85,000</td>
                                <td><span class="badge badge-success">Approved</span></td>
                                <td>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(0)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="bulk-checkbox oc-checkbox" data-id="1"></td>
                                <td>Zyla</td>
                                <td class="race-namekian">Namekian</td>
                                <td>@NamekianLore</td>
                                <td>42,000</td>
                                <td><span class="badge badge-success">Approved</span></td>
                                <td>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(1)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="bulk-checkbox oc-checkbox" data-id="2"></td>
                                <td>Vex</td>
                                <td class="race-frieza">Frieza Race</td>
                                <td>@CoolerThanFrieza</td>
                                <td>120,000</td>
                                <td><span class="badge badge-warning">Pending</span></td>
                                <td>
                                    <button class="btn btn-sm btn-success" onclick="approveOC(2)"><i class="fas fa-check"></i></button>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(2)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="bulk-checkbox oc-checkbox" data-id="3"></td>
                                <td>Cyra</td>
                                <td class="race-android">Android</td>
                                <td>@TechGuru</td>
                                <td>95,000</td>
                                <td><span class="badge badge-success">Approved</span></td>
                                <td>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(3)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="bulk-checkbox oc-checkbox" data-id="4"></td>
                                <td>Bora</td>
                                <td class="race-majin">Majin</td>
                                <td>@MagicUser</td>
                                <td>78,000</td>
                                <td><span class="badge badge-warning">Pending</span></td>
                                <td>
                                    <button class="btn btn-sm btn-success" onclick="approveOC(4)"><i class="fas fa-check"></i></button>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(4)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="bulk-checkbox oc-checkbox" data-id="5"></td>
                                <td>Kito</td>
                                <td class="race-kai">Kai</td>
                                <td>@DivineBeing</td>
                                <td>65,000</td>
                                <td><span class="badge badge-warning">Pending</span></td>
                                <td>
                                    <button class="btn btn-sm btn-success" onclick="approveOC(5)"><i class="fas fa-check"></i></button>
                                    <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteOC(5)"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="text-center mt-20">
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Export OC Data
                    </button>
                </div>
            </section>
        </main>

        <!-- Modals -->
        <div id="admin-login-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Admin Login</h2>
                    <button class="modal-close" onclick="hideModal('admin-login-modal')">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Admin Password</label>
                        <input type="password" class="form-input" placeholder="Enter admin password" id="adminPassword">
                    </div>
                    <div class="d-flex justify-between">
                        <button type="button" class="btn" onclick="hideModal('admin-login-modal')">Cancel</button>
                        <button type="button" class="btn btn-primary" onclick="loginAsAdmin()">Login</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="create-oc-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Create New OC</h2>
                    <button class="modal-close" onclick="hideModal('create-oc-modal')">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="createOCForm">
                        <div class="form-group">
                            <label class="form-label">Character Name</label>
                            <input type="text" class="form-input" placeholder="Enter character name" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Race</label>
                            <select class="form-select" required>
                                <option value="">Select Race</option>
                                <option value="saiyan">Saiyan</option>
                                <option value="namekian">Namekian</option>
                                <option value="frieza">Frieza Race</option>
                                <option value="android">Android</option>
                                <option value="human">Human</option>
                                <option value="majin">Majin</option>
                                <option value="kai">Kai</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Power Level</label>
                            <input type="number" class="form-input" placeholder="Enter power level" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Backstory</label>
                            <textarea class="form-textarea" placeholder="Describe the character's backstory"></textarea>
                        </div>
                        <div class="d-flex justify-between">
                            <button type="button" class="btn" onclick="hideModal('create-oc-modal')">Cancel</button>
                            <button type="submit" class="btn btn-primary">Create Character</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="edit-timeline-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="timelineModalTitle">Add Timeline Event</h2>
                    <button class="modal-close" onclick="hideModal('edit-timeline-modal')">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="timelineEventForm">
                        <div class="form-group">
                            <label class="form-label">Event Date</label>
                            <input type="text" class="form-input" placeholder="e.g. Age 761" id="eventDate" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Event Title</label>
                            <input type="text" class="form-input" placeholder="Enter event title" id="eventTitle" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Event Description</label>
                            <textarea class="form-textarea" placeholder="Describe the event" id="eventDescription" required></textarea>
                        </div>
                        <div class="d-flex justify-between">
                            <button type="button" class="btn" onclick="hideModal('edit-timeline-modal')">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Event</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="edit-relations-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Edit Relationships</h2>
                    <button class="modal-close" onclick="hideModal('edit-relations-modal')">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Select Character</label>
                        <select class="form-select" id="editRelationChar">
                            <option value="Kairo">Kairo</option>
                            <option value="Zyla">Zyla</option>
                            <option value="Vex">Vex</option>
                            <option value="Cyra">Cyra</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Relationships</label>
                        <div id="relationList">
                            <div class="d-flex align-center justify-between mb-10">
                                <span>Zyla (Namekian)</span>
                                <span>Ally</span>
                                <button class="btn btn-sm btn-danger" onclick="deleteRelationship('Kairo', 'Zyla')"><i class="fas fa-trash"></i></button>
                            </div>
                            <div class="d-flex align-center justify-between mb-10">
                                <span>Vex (Frieza Race)</span>
                                <span>Rival</span>
                                <button class="btn btn-sm btn-danger" onclick="deleteRelationship('Kairo', 'Vex')"><i class="fas fa-trash"></i></button>
                            </div>
                            <div class="d-flex align-center justify-between">
                                <span>Cyra (Android)</span>
                                <span>Mentor</span>
                                <button class="btn btn-sm btn-danger" onclick="deleteRelationship('Kairo', 'Cyra')"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-between">
                        <button type="button" class="btn" onclick="hideModal('edit-relations-modal')">Close</button>
                        <button type="button" class="btn btn-primary">Save Changes</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- OC Image Modal -->
        <div id="oc-image-modal" class="modal">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h2>OC Image</h2>
                    <button class="modal-close" onclick="hideModal('oc-image-modal')">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="modalImageContainer" style="text-align: center;">
                        <img id="modalImage" src="" alt="OC Image" style="max-width: 100%; max-height: 70vh;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        const SAVE_KEY = 'dboc_sheet_v1';
        const COLLECTION_KEY = 'dboc_collection_v1';
        const TIMELINE_KEY = 'db_timeline_v1';
        const RELATIONSHIPS_KEY = 'db_relationships_v1';
        
        // Sample data for demonstration
        let sampleOCs = [
            { id: 0, name: 'Kairo', race: 'Saiyan', power: 85000, status: 'approved', creator: '@DragonFan92', image: null },
            { id: 1, name: 'Zyla', race: 'Namekian', power: 42000, status: 'approved', creator: '@NamekianLore', image: null },
            { id: 2, name: 'Vex', race: 'Frieza Race', power: 120000, status: 'pending', creator: '@CoolerThanFrieza', image: null },
            { id: 3, name: 'Cyra', race: 'Android', power: 95000, status: 'approved', creator: '@TechGuru', image: null },
            { id: 4, name: 'Bora', race: 'Majin', power: 78000, status: 'pending', creator: '@MagicUser', image: null },
            { id: 5, name: 'Kito', race: 'Kai', power: 65000, status: 'pending', creator: '@DivineBeing', image: null }
        ];

        let timelineEvents = [
            { date: 'Age 761', title: 'The Saiyan Exodus', description: 'A group of Saiyans escapes Planet Vegeta\'s destruction and finds refuge in Universe 6.' },
            { date: 'Age 774', title: 'The Galactic Conflict', description: 'War breaks out between the Frieza Force and a rebellion led by surviving Saiyans.' },
            { date: 'Age 780', title: 'The New Namekian Era', description: 'Namekians discover a new way to fuse, creating powerful warriors to protect their planet.' },
            { date: 'Age 785', title: 'The Android Uprising', description: 'A new generation of androids becomes self-aware and seeks independence.' },
            { date: 'Present Day', title: 'The Multiversal Tournament', description: 'Zeno announces a tournament that will include fighters from all universes.' }
        ];

        let relationships = {
            'Kairo': [
                { character: 'Zyla', relation: 'Ally' },
                { character: 'Vex', relation: 'Rival' },
                { character: 'Cyra', relation: 'Mentor' }
            ]
        };

        // Power Level Portrait mapping
        const PL_PORTRAITS = [
            {min: 0, max: 99, name:'Farmer with Shotgun', file:'https://static.wikia.nocookie.net/dragonball/images/2/2e/Farmer.png/revision/latest/scale-to-width-down/300?cb=20180315184937', color:'#8fc3ff'},
            {min: 100, max: 399, name:'Yamcha (Early DB)', file:'https://static.wikia.nocookie.net/dragonball/images/1/14/YamchaAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053129', color:'#9fb8ff'},
            {min: 400, max: 799, name:'Master Roshi', file:'https://static.wikia.nocookie.net/dragonball/images/3/3c/MasterRoshiAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053130', color:'#9fb8ff'},
            {min: 800, max: 999, name:'Krillin (Early DB)', file:'https://static.wikia.nocookie.net/dragonball/images/1/1a/KrillinAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053130', color:'#9fb8ff'},
            {min: 1000, max: 1499, name:'Tien (Early DB)', file:'https://static.wikia.nocookie.net/dragonball/images/f/fc/TienAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053131', color:'#2fb44f'},
            {min: 1500, max: 3999, name:'Piccolo (Saiyan Saga)', file:'https://static.wikia.nocookie.net/dragonball/images/0/0b/PiccoloAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053131', color:'#2fb44f'},
            {min: 4000, max: 7999, name:'Goku (Saiyan Saga)', file:'https://static.wikia.nocookie.net/dragonball/images/8/8e/GokuSaiyanSaga.png/revision/latest/scale-to-width-down/300?cb=20190418053132', color:'#ffd24d'},
            {min: 8000, max: 11999, name:'Vegeta (Saiyan Saga)', file:'https://static.wikia.nocookie.net/dragonball/images/0/0d/VegetaSaiyanSaga.png/revision/latest/scale-to-width-down/300?cb=20190418053132', color:'#ff8a00'},
            {min: 12000, max: 17999, name:'Nappa', file:'https://static.wikia.nocookie.net/dragonball/images/9/9e/NappaAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053133', color:'#ff8a00'},
            {min: 18000, max: 23999, name:'Recoome', file:'https://static.wikia.nocookie.net/dragonball/images/0/0f/RecoomeAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053133', color:'#ff8a00'},
            {min: 24000, max: 29999, name:'Jeice', file:'https://static.wikia.nocookie.net/dragonball/images/3/3b/JeiceAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053134', color:'#ff8a00'},
            {min: 30000, max: 39999, name:'Burter', file:'https://static.wikia.nocookie.net/dragonball/images/1/1b/BurterAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053134', color:'#ff8a00'},
            {min: 40000, max: 49999, name:'Captain Ginyu', file:'https://static.wikia.nocookie.net/dragonball/images/5/5a/CaptainGinyuAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053135', color:'#ff8a00'},
            {min: 50000, max: 529999, name:'Frieza First Form', file:'https://static.wikia.nocookie.net/dragonball/images/7/7a/FriezaFirstFormAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053135', color:'#b270ff'},
            {min: 530000, max: 999999, name:'Frieza Final Form (Suppressed)', file:'https://static.wikia.nocookie.net/dragonball/images/4/4d/FriezaFinalFormAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053136', color:'#b270ff'},
            {min: 1000000, max: 14999999, name:'SSJ Goku (Namek)', file:'https://static.wikia.nocookie.net/dragonball/images/5/5f/GokuSuperSaiyanNamek.png/revision/latest/scale-to-width-down/300?cb=20190418053136', color:'#ffd700'},
            {min: 15000000, max: 29999999, name:'Android 17', file:'https://static.wikia.nocookie.net/dragonball/images/7/7b/Android17Anime.png/revision/latest/scale-to-width-down/300?cb=20190418053137', color:'#8eff8a'},
            {min: 30000000, max: 59999999, name:'Android 18', file:'https://static.wikia.nocookie.net/dragonball/images/0/0f/Android18Anime.png/revision/latest/scale-to-width-down/300?cb=20190418053137', color:'#8eff8a'},
            {min: 60000000, max: 89999999, name:'Imperfect Cell', file:'https://static.wikia.nocookie.net/dragonball/images/8/8a/ImperfectCellAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053138', color:'#8eff8a'},
            {min: 90000000, max: 119999999, name:'Semi-Perfect Cell', file:'https://static.wikia.nocookie.net/dragonball/images/9/9e/SemiPerfectCellAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053138', color:'#8eff8a'},
            {min: 120000000, max: 199999999, name:'Perfect Cell', file:'https://static.wikia.nocookie.net/dragonball/images/4/4f/PerfectCellAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053139', color:'#8eff8a'},
            {min: 200000000, max: 299999999, name:'Super Perfect Cell', file:'https://static.wikia.nocookie.net/dragonball/images/4/4f/PerfectCellAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053139', color:'#8eff8a'},
            {min: 300000000, max: 499999999, name:'SSJ2 Gohan', file:'https://static.wikia.nocookie.net/dragonball/images/3/3d/GohanSuperSaiyan2Anime.png/revision/latest/scale-to-width-down/300?cb=20190418053140', color:'#ffd700'},
            {min: 500000000, max: 999999999, name:'Fat Buu', file:'https://static.wikia.nocookie.net/dragonball/images/2/2c/MajinBuuAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053140', color:'#ff77ff'},
            {min: 1000000000, max: 1999999999, name:'Super Buu', file:'https://static.wikia.nocookie.net/dragonball/images/7/7c/SuperBuuAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053141', color:'#ff77ff'},
            {min: 2000000000, max: 4999999999, name:'Kid Buu', file:'https://static.wikia.nocookie.net/dragonball/images/5/5d/KidBuuAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053141', color:'#ff77ff'},
            {min: 5000000000, max: 9999999999, name:'SSJ3 Goku', file:'https://static.wikia.nocookie.net/dragonball/images/8/8c/GokuSuperSaiyan3Anime.png/revision/latest/scale-to-width-down/300?cb=20190418053142', color:'#ffd700'},
            {min: 10000000000, max: 29999999999, name:'SSJ God Goku', file:'https://static.wikia.nocookie.net/dragonball/images/1/1e/GokuSuperSaiyanGodAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053142', color:'#ff4444'},
            {min: 30000000000, max: 99999999999, name:'SSJ Blue Goku', file:'https://static.wikia.nocookie.net/dragonball/images/9/9a/GokuSuperSaiyanBlueAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053143', color:'#00b7ff'},
            {min: 100000000000, max: 499999999999, name:'Golden Frieza', file:'https://static.wikia.nocookie.net/dragonball/images/5/5f/GoldenFriezaAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053143', color:'#ffd700'},
            {min: 500000000000, max: 999999999999, name:'SSJ Blue Vegito', file:'https://static.wikia.nocookie.net/dragonball/images/8/8c/VegitoBlueAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053144', color:'#00b7ff'},
            {min: 1000000000000, max: 4999999999999, name:'Beerus', file:'https://static.wikia.nocookie.net/dragonball/images/5/5e/BeerusAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053144', color:'#ffd8b3'},
            {min: 5000000000000, max: 9999999999999, name:'SSJ Blue Evolution Vegeta', file:'https://static.wikia.nocookie.net/dragonball/images/4/4e/VegetaSuperSaiyanBlueEvolvedAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053145', color:'#00b7ff'},
            {min: 10000000000000, max: 29999999999999, name:'Ultra Instinct Omen Goku', file:'https://static.wikia.nocookie.net/dragonball/images/6/6e/GokuUltraInstinctSignAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053145', color:'#e8f0ff'},
            {min: 30000000000000, max: 99999999999999, name:'Jiren (Full Power)', file:'https://static.wikia.nocookie.net/dragonball/images/7/7d/JirenFullPowerAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053146', color:'#ff4444'},
            {min: 100000000000000, max: 499999999999999, name:'Mastered Ultra Instinct Goku', file:'https://static.wikia.nocookie.net/dragonball/images/9/9c/GokuUltraInstinctAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053146', color:'#e8f0ff'},
            {min: 500000000000000, max: 999999999999999, name:'SSJ4 Goku', file:'https://static.wikia.nocookie.net/dragonball/images/4/4c/GokuSuperSaiyan4Anime.png/revision/latest/scale-to-width-down/300?cb=20190418053147', color:'#cc0033'},
            {min: 1000000000000000, max: 4999999999999999, name:'Omega Shenron', file:'https://static.wikia.nocookie.net/dragonball/images/8/8e/OmegaShenronAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053147', color:'#cc0033'},
            {min: 5000000000000000, max: 9999999999999999, name:'SSJ4 Gogeta', file:'https://static.wikia.nocookie.net/dragonball/images/9/9c/GogetaSuperSaiyan4Anime.png/revision/latest/scale-to-width-down/300?cb=20190418053148', color:'#cc0033'},
            {min: 10000000000000000, max: Number.POSITIVE_INFINITY, name:'Zeno / Grand Priest', file:'https://static.wikia.nocookie.net/dragonball/images/5/5e/ZenoAnime.png/revision/latest/scale-to-width-down/300?cb=20190418053148', color:'#e8f0ff'}
        ];

        // Transform glow mapping
        const TRANSFORM_GLOWS = [
            {keys:['super saiyan 4','ssj4','ssj 4','saiyan 4'], color:'#cc0033'},
            {keys:['super saiyan 3','ssj3','super saiyan 3'], color:'#ffd700'},
            {keys:['super saiyan 2','ssj2','super saiyan 2'], color:'#ffd700'},
            {keys:['super saiyan 1','ssj1','super saiyan'], color:'#ffd700'},
            {keys:['super saiyan god','ssg','saiyan god'], color:'#ff4444'},
            {keys:['super saiyan blue','ssb','saiyan blue','super saiyan god super saiyan'], color:'#00b7ff'},
            {keys:['rosé','rose','super saiyan rosé'], color:'#ff88ff'},
            {keys:['ultra instinct','mui','ui','mastered ultra instinct'], color:'#e8f0ff'},
            {keys:['golden great ape','great ape'], color:'#ff8800'},
            {keys:['legendary','berserk','lssj'], color:'#7fff00'},
            {keys:['kaioken'], color:'#ff4500'}
        ];

        document.addEventListener('DOMContentLoaded', function() {
            // Navigation
            const navButtons = document.querySelectorAll('.nav-btn');
            const pages = document.querySelectorAll('.page');
            
            navButtons.forEach(button => {
                button.addEventListener('click', function() {
                    if (this.id === 'adminLoginBtn') {
                        showModal('admin-login-modal');
                        return;
                    }
                    
                    const targetPage = this.getAttribute('data-page');
                    
                    // Update active navigation button
                    navButtons.forEach(btn => {
                        if (btn.getAttribute('data-page')) {
                            btn.classList.remove('active');
                        }
                    });
                    this.classList.add('active');
                    
                    // Show target page
                    pages.forEach(page => {
                        page.classList.remove('active');
                        if (page.id === targetPage) {
                            page.classList.add('active');
                        }
                    });
                });
            });
            
            // Check if already in admin mode
            if (localStorage.getItem('adminMode') === 'true') {
                enableAdminMode();
            }

            // Load saved data
            loadSavedData();
            
            // Set up event listeners
            setupEventListeners();
        });
        
        // Modal functionality
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // Close modal when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(event) {
                if (event.target === this) {
                    this.classList.remove('active');
                }
            });
        });
        
        // Admin functionality
        function loginAsAdmin() {
            const password = document.getElementById('adminPassword').value;
            // Simple password check for demo purposes
            if (password === 'dragonball') {
                enableAdminMode();
                hideModal('admin-login-modal');
                localStorage.setItem('adminMode', 'true');
            } else {
                alert('Incorrect password. Try "dragonball" for demo purposes.');
            }
        }
        
        function enableAdminMode() {
            document.body.classList.add('admin-mode');
            document.getElementById('adminBadge').style.display = 'block';
            document.getElementById('adminLoginBtn').innerHTML = '<i class="fas fa-unlock"></i> Admin Logout';
            
            // Show the Manage OCs navigation button
            document.getElementById('manageOcsBtn').style.display = 'flex';
            
            // Change login button to logout
            document.getElementById('adminLoginBtn').onclick = function() {
                disableAdminMode();
            };
        }
        
        function disableAdminMode() {
            document.body.classList.remove('admin-mode');
            document.getElementById('adminBadge').style.display = 'none';
            document.getElementById('adminLoginBtn').innerHTML = '<i class="fas fa-lock"></i> Admin Login';
            
            // Hide the Manage OCs navigation button
            document.getElementById('manageOcsBtn').style.display = 'none';
            
            localStorage.setItem('adminMode', 'false');
            
            // Revert logout button to login
            document.getElementById('adminLoginBtn').onclick = function() {
                showModal('admin-login-modal');
            };
        }
        
        // OC Sheet functionality
        function toggleSection(head) {
            const section = head.parentElement;
            const isCollapsed = section.classList.toggle('collapsed');
            const meta = head.querySelector('.meta');
            if (meta) meta.textContent = isCollapsed ? '▲' : '▼';
        }
        
        function toggleAllSections(expand) {
            document.querySelectorAll('.oc-section').forEach(s => {
                s.classList.toggle('collapsed', !expand);
                const meta = s.querySelector('.meta');
                if (meta) meta.textContent = expand ? '▼' : '▲';
            });
        }
        
        // Show a specific page
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // Update active nav button
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if (btn.getAttribute('data-page') === pageId) {
                    btn.classList.add('active');
                } else if (btn.getAttribute('data-page')) {
                    btn.classList.remove('active');
                }
            });
        }
        
        // Power Level functionality
        function readPower() {
            const n = parseInt(document.getElementById('powerInput').value) || 0;
            document.getElementById('plValue').textContent = n ? n.toLocaleString() : '—';
            
            let cat = 'Unknown';
            if (n === 0) cat = 'No reading';
            else if (n < 1000) cat = 'Rookie Fighter';
            else if (n < 10000) cat = 'Martial Artist';
            else if (n < 100000) cat = 'Elite Warrior';
            else if (n < 1000000) cat = 'Super Warrior';
            else if (n < 10000000) cat = 'Planet Buster';
            else if (n < 1000000000) cat = 'Godly Being';
            else cat = 'Multiversal Entity';
            
            document.getElementById('plCategory').textContent = cat;
            
            // Over 9000 easter egg
            if (n >= 9001 && n < 1000000000) {
                document.getElementById('plCategory').textContent = "IT'S OVER 9000!";
            }
            
            // Update portrait based on power level
            const match = PL_PORTRAITS.find(p => n >= p.min && n <= p.max) || PL_PORTRAITS[0];
            document.getElementById('plPortraitName').textContent = match.name;
            document.getElementById('plPortraitRange').textContent = `${match.min.toLocaleString()} — ${(match.max === Number.POSITIVE_INFINITY) ? '∞' : match.max.toLocaleString()}`;
            
            // Set image and aura
            document.getElementById('plPortraitImg').src = match.file;
            document.getElementById('plPortraitAura').style.backgroundColor = match.color;
            document.getElementById('plPortraitAura').style.boxShadow = `0 0 15px ${match.color}`;
            
            // Set border color
            document.getElementById('plPortraitWrap').style.borderColor = match.color;
        }
        
        // Dynamic entries for abilities, techniques, etc.
        function addEntry(listId, kind = 'generic', data = {}) {
            const list = document.getElementById(listId);
            if (!list) return;
            
            const entry = document.createElement('div');
            entry.className = 'entry';
            entry.draggable = true;
            
            const colorPickerHtml = (kind === 'transform') ? 
                `<div class="color-row"><label style="font-size:0.78rem;color:var(--accent-blue)">Glow</label><input type="color" class="transform-color" title="Pick glow color (optional)" value="${data.glowColor || '#ffffff'}"></div>` : '';
            
            entry.innerHTML = `
                <div class="entry-number"></div>
                <div class="entry-img-wrap" title="Click to change image">
                    <img src="${data.image ? data.image : 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NCIgaGVpZ2h0PSI4NCI+PHJlY3Qgd2lkdGg9Ijg0IiBoZWlnaHQ9Ijg0IiByeD0iMTAiIGZpbGw9IiMwZTBmMTUiLz48dGV4dCB4PSI0MiIgeT0iNDIiIGZvbnQtZmFtaWx5PSJPcmJpdHJvbixzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5VcGxvYWQ8L3RleHQ+PC9zdmc+'}" alt="entry image"/>
                </div>
                <input class="file-input" type="file" accept="image/*" />
                <div class="entry-content">
                    <input type="text" class="oc-input entry-name" placeholder="Name / Title" value="${data.name || ''}" />
                    <textarea class="oc-textarea entry-desc" placeholder="Description...">${data.description || ''}</textarea>
                    <input type="text" class="oc-input entry-extra" placeholder="Extra details (multiplier, notes)" value="${data.extra || ''}" />
                    ${colorPickerHtml}
                </div>
                <button class="remove-btn" title="Remove">✖</button>
            `;
            
            list.appendChild(entry);
            
            // Set up event listeners for this entry
            const imgWrap = entry.querySelector('.entry-img-wrap');
            const img = imgWrap.querySelector('img');
            const fileInput = entry.querySelector('.file-input');
            const nameInput = entry.querySelector('.entry-name');
            const descInput = entry.querySelector('.entry-desc');
            const extraInput = entry.querySelector('.entry-extra');
            const removeBtn = entry.querySelector('.remove-btn');
            const colorInput = entry.querySelector('.transform-color');
            
            // Image upload functionality
            imgWrap.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        img.src = e.target.result;
                        saveState();
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Name change for transform glow
            nameInput.addEventListener('input', function() {
                applyGlowForName(entry, nameInput.value);
                if (colorInput && colorInput.value) {
                    const c = colorInput.value;
                    entry.style.boxShadow = `0 10px 30px rgba(0,0,0,0.5), 0 0 20px ${c}33`;
                    entry.style.borderColor = c;
                }
                saveState();
            });
            
            // Other input changes
            descInput.addEventListener('input', saveState);
            extraInput.addEventListener('input', saveState);
            
            // Color picker for transformations
            if (colorInput) {
                colorInput.addEventListener('input', function() {
                    const c = colorInput.value;
                    entry.style.boxShadow = `0 10px 30px rgba(0,0,0,0.5), 0 0 20px ${c}33`;
                    entry.style.borderColor = c;
                    saveState();
                });
            }
            
            // Remove button
            removeBtn.addEventListener('click', function() {
                entry.remove();
                renumberEntries(listId);
                saveState();
            });
            
            // Initial glow application
            applyGlowForName(entry, nameInput.value);
            renumberEntries(listId);
            saveState();
        }
        
        function applyGlowForName(entryEl, name) {
            if (!name) {
                entryEl.style.boxShadow = '';
                entryEl.style.borderColor = '';
                return;
            }
            
            const t = name.toLowerCase();
            for (const map of TRANSFORM_GLOWS) {
                for (const key of map.keys) {
                    if (t.includes(key)) {
                        const c = map.color;
                        entryEl.style.boxShadow = `0 10px 30px rgba(0,0,0,0.5), 0 0 20px ${c}33`;
                        entryEl.style.borderColor = c;
                        return;
                    }
                }
            }
            
            entryEl.style.boxShadow = `0 10px 20px rgba(0,0,0,0.5)`;
            entryEl.style.borderColor = 'rgba(0,183,255,0.06)';
        }
        
        function renumberEntries(listId) {
            const list = document.getElementById(listId);
            if (!list) return;
            
            const nums = list.querySelectorAll('.entry-number');
            Array.from(nums).forEach((n, i) => {
                n.textContent = (i + 1) + ':';
            });
        }
        
        function gatherEntries(listId) {
            const list = document.getElementById(listId);
            if (!list) return [];
            
            return Array.from(list.getElementsByClassName('entry')).map(entry => {
                const img = entry.querySelector('img')?.src || null;
                const name = entry.querySelector('.entry-name')?.value || '';
                const description = entry.querySelector('.entry-desc')?.value || '';
                const extra = entry.querySelector('.entry-extra')?.value || '';
                const color = entry.querySelector('.transform-color')?.value || null;
                
                return { image: img, name, description, extra, glowColor: color };
            });
        }
        
        // Build current OC data
        function buildCurrentOC() {
            return {
                id: 'oc_' + Date.now(),
                name: document.getElementById('ocName').value,
                alias: document.getElementById('ocAlias').value,
                race: document.getElementById('raceSelect').value,
                universe: document.getElementById('universe').value,
                homeplanet: document.getElementById('homeplanet').value,
                age: document.getElementById('age').value,
                height: document.getElementById('height').value,
                weight: document.getElementById('weight').value,
                eyecolor: document.getElementById('eyecolor').value,
                haircolor: document.getElementById('haircolor').value,
                blood: document.getElementById('blood').value,
                affils: document.getElementById('affils').value,
                powerlevel: document.getElementById('powerInput').value,
                backstory_short: document.getElementById('backstory_short').value,
                backstory_full: document.getElementById('backstory_full').value,
                traits: document.getElementById('traits').value,
                likes: document.getElementById('likes').value,
                fears: document.getElementById('fears').value,
                goals: document.getElementById('goals').value,
                battles: document.getElementById('battles').value,
                tagline: document.getElementById('sheetTitle').textContent,
                signatureAbilities: gatherEntries('abilitiesList'),
                techniques: gatherEntries('techniquesList'),
                transformations: gatherEntries('transformsList'),
                equipment: gatherEntries('equipmentList'),
                posterDataUrl: document.getElementById('poster').style.backgroundImage ? 
                    document.getElementById('poster').style.backgroundImage.replace(/^url\(["']?/, '').replace(/["']?\)$/, '') : null
            };
        }
        
        // Save and load state
        function saveState() {
            try {
                const fields = Array.from(document.querySelectorAll('#oc-sheet input, #oc-sheet textarea, #oc-sheet select'));
                const data = {};
                
                fields.forEach(f => {
                    if (f.id) data[f.id] = f.value;
                });
                
                data.tagline = document.getElementById('sheetTitle').textContent;
                ['abilitiesList', 'techniquesList', 'transformsList', 'equipmentList'].forEach(id => {
                    data[id] = gatherEntries(id);
                });
                
                data._poster = document.getElementById('poster').style.backgroundImage ? 
                    document.getElementById('poster').style.backgroundImage.replace(/^url\(["']?/, '').replace(/["']?\)$/, '') : null;
                
                localStorage.setItem(SAVE_KEY, JSON.stringify(data));
            } catch (e) {
                console.warn('saveState error', e);
            }
        }
        
        function loadState() {
            try {
                const raw = localStorage.getItem(SAVE_KEY);
                if (!raw) return;
                
                const data = JSON.parse(raw);
                
                Object.keys(data).forEach(k => {
                    if (k === 'tagline') {
                        document.getElementById('sheetTitle').textContent = data[k] || 'Character Quote / Tagline — (click to edit)';
                        return;
                    }
                    
                    if (['abilitiesList', 'techniquesList', 'transformsList', 'equipmentList'].includes(k)) {
                        const listEl = document.getElementById(k);
                        if (!listEl) return;
                        
                        listEl.innerHTML = '';
                        (data[k] || []).forEach(item => {
                            addEntry(k, (k === 'transformsList' ? 'transform' : 'generic'), item);
                        });
                        return;
                    }
                    
                    if (k === '_poster' && data[k]) {
                        document.getElementById('poster').style.backgroundImage = `url(${data[k]})`;
                        updateImageViewer();
                        return;
                    }
                    
                    const el = document.getElementById(k);
                    if (el) el.value = data[k];
                });
                
                if (document.getElementById('powerInput').value) {
                    readPower();
                }
            } catch (e) {
                console.warn('loadState error', e);
            }
        }
        
        // Update image viewer display
        function updateImageViewer() {
            const poster = document.getElementById('poster');
            const placeholder = document.getElementById('imagePlaceholder');
            
            if (poster.style.backgroundImage && poster.style.backgroundImage !== 'none') {
                placeholder.style.display = 'none';
                poster.style.display = 'block';
            } else {
                placeholder.style.display = 'block';
                poster.style.display = 'none';
            }
        }
        
        // Save OC to collection
        function saveOCToCollection() {
            const oc = buildCurrentOC();
            const existing = JSON.parse(localStorage.getItem(COLLECTION_KEY) || '[]');
            existing.push(oc);
            localStorage.setItem(COLLECTION_KEY, JSON.stringify(existing));
            showToast('Saved OC to collection');
        }
        
        // Download JSON
        function downloadJSON() {
            const data = buildCurrentOC();
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = (data.name || 'oc') + '_sheet.json';
            document.body.appendChild(a);
            a.click();
            a.remove();
            URL.revokeObjectURL(url);
        }
        
        // Fill example data
        function fillExample() {
            document.getElementById('ocName').value = 'Raian';
            document.getElementById('ocAlias').value = 'Blaze of Saiyra';
            document.getElementById('raceSelect').value = 'Saiyan';
            document.getElementById('universe').value = 'Universe 7';
            document.getElementById('homeplanet').value = 'Planet Vegeta';
            document.getElementById('backstory_short').value = 'A displaced Saiyan raised on the frontier worlds...';
            
            addEntry('abilitiesList', 'generic', { name: 'Zenkai Surge', description: 'Rapid recovery', extra: 'Trigger' });
            addEntry('techniquesList', 'generic', { name: 'Nova Smash', description: 'Punch infused with star-energy', extra: 'Signature' });
            addEntry('transformsList', 'transform', { name: 'Super Saiyan', description: 'Classic golden hair', extra: 'x50', glowColor: '#ffd700' });
            addEntry('equipmentList', 'generic', { name: 'Old Scouter', description: 'Keeps readings', extra: 'Damaged lens' });
            
            document.getElementById('traits').value = 'Hot-headed, Loyal, Impulsive';
            document.getElementById('powerInput').value = '9200';
            readPower();
            saveState();
        }
        
        // Clear all data
        function clearAll() {
            if (!confirm('CLEAR EVERYTHING?\nThis will remove all fields on the current sheet.\nThis action is irreversible. Proceed?')) return;
            
            try {
                // Clear fields
                document.querySelectorAll('#oc-sheet input, #oc-sheet textarea, #oc-sheet select').forEach(el => {
                    el.value = '';
                });
                
                // Clear dynamic lists
                ['abilitiesList', 'techniquesList', 'transformsList', 'equipmentList'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.innerHTML = '';
                });
                
                // Clear poster
                document.getElementById('poster').style.backgroundImage = 'none';
                updateImageViewer();
                
                // Reset tagline
                document.getElementById('sheetTitle').textContent = 'Character Quote / Tagline — (click to edit)';
                
                // Remove saved state
                localStorage.removeItem(SAVE_KEY);
                
                showToast('Cleared sheet data');
            } catch (e) {
                console.warn('clearAll error', e);
                showToast('Failed to clear everything');
            }
        }
        
        // Toast notification
        function showToast(msg, t = 1600) {
            const existing = document.getElementById('__toast__');
            if (existing) existing.remove();
            
            const div = document.createElement('div');
            div.id = '__toast__';
            div.textContent = msg;
            div.style.position = 'fixed';
            div.style.right = '18px';
            div.style.bottom = '18px';
            div.style.background = 'linear-gradient(90deg, var(--accent-blue), rgba(0,183,255,0.08))';
            div.style.color = '#fff';
            div.style.padding = '8px 12px';
            div.style.borderRadius = '8px';
            div.style.boxShadow = '0 10px 30px rgba(0,0,0,0.6)';
            div.style.zIndex = '9999';
            
            document.body.appendChild(div);
            
            setTimeout(() => {
                if (div.parentNode) div.parentNode.removeChild(div);
            }, t);
        }
        
        // Timeline editing
        function editTimelineEvent(index) {
            const event = timelineEvents[index];
            document.getElementById('eventDate').value = event.date;
            document.getElementById('eventTitle').value = event.title;
            document.getElementById('eventDescription').value = event.description;
            
            document.getElementById('timelineModalTitle').textContent = 'Edit Timeline Event';
            
            // Store the index being edited
            document.getElementById('edit-timeline-modal').dataset.editIndex = index;
            
            showModal('edit-timeline-modal');
        }
        
        function deleteTimelineEvent(index) {
            if (confirm('Are you sure you want to delete this timeline event?')) {
                timelineEvents.splice(index, 1);
                
                // Save to localStorage
                localStorage.setItem(TIMELINE_KEY, JSON.stringify(timelineEvents));
                
                // Update display
                renderTimeline();
                
                showToast('Timeline event deleted');
            }
        }
        
        function saveTimelineEvent() {
            const date = document.getElementById('eventDate').value;
            const title = document.getElementById('eventTitle').value;
            const description = document.getElementById('eventDescription').value;
            
            if (!date || !title || !description) {
                alert('Please fill in all fields');
                return;
            }
            
            const editIndex = document.getElementById('edit-timeline-modal').dataset.editIndex;
            
            if (editIndex !== undefined) {
                // Editing existing event
                timelineEvents[editIndex] = { date, title, description };
            } else {
                // Adding new event
                timelineEvents.push({ date, title, description });
            }
            
            // Save to localStorage
            localStorage.setItem(TIMELINE_KEY, JSON.stringify(timelineEvents));
            
            // Update display
            renderTimeline();
            
            hideModal('edit-timeline-modal');
            showToast('Timeline event saved');
        }
        
        function renderTimeline() {
            const container = document.getElementById('timelineContainer');
            if (!container) return;
            
            container.innerHTML = '';
            
            timelineEvents.forEach((event, index) => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                item.innerHTML = `
                    <div class="timeline-content">
                        <div class="timeline-date">
                            <i class="fas fa-calendar-alt"></i> ${event.date}
                            <div class="admin-only">
                                <button class="btn btn-sm" onclick="editTimelineEvent(${index})"><i class="fas fa-edit"></i></button>
                                <button class="btn btn-sm btn-danger" onclick="deleteTimelineEvent(${index})"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        <h3 class="timeline-title">${event.title}</h3>
                        <p class="timeline-desc">${event.description}</p>
                    </div>
                `;
                
                container.appendChild(item);
            });
        }
        
        // Relationship management
        function addRelationship() {
            const char1 = document.getElementById('relationChar1').value;
            const char2 = document.getElementById('relationChar2').value;
            const relation = document.getElementById('relationType').value;
            
            if (!char1 || !char2) {
                alert('Please select both characters');
                return;
            }
            
            if (char1 === char2) {
                alert('Characters cannot have a relationship with themselves');
                return;
            }
            
            if (!relationships[char1]) {
                relationships[char1] = [];
            }
            
            // Check if relationship already exists
            const existingIndex = relationships[char1].findIndex(r => r.character === char2);
            if (existingIndex !== -1) {
                relationships[char1][existingIndex].relation = relation;
            } else {
                relationships[char1].push({ character: char2, relation });
            }
            
            // Save to localStorage
            localStorage.setItem(RELATIONSHIPS_KEY, JSON.stringify(relationships));
            
            // Update display
            renderRelationshipTree();
            
            showToast('Relationship added');
        }
        
        function deleteRelationship(char1, char2) {
            if (confirm(`Are you sure you want to delete the relationship between ${char1} and ${char2}?`)) {
                if (relationships[char1]) {
                    relationships[char1] = relationships[char1].filter(r => r.character !== char2);
                    
                    // Save to localStorage
                    localStorage.setItem(RELATIONSHIPS_KEY, JSON.stringify(relationships));
                    
                    // Update display
                    renderRelationshipTree();
                    
                    showToast('Relationship deleted');
                }
            }
        }
        
        function renderRelationshipTree() {
            const tree = document.getElementById('relationshipTree');
            if (!tree) return;
            
            // For simplicity, we'll just show Kairo's relationships
            const kairoRelations = relationships['Kairo'] || [];
            
            tree.innerHTML = `
                <div class="tree-node">Kairo (Saiyan)</div>
                <div class="tree-children">
                    ${kairoRelations.map(rel => `
                        <div class="tree">
                            <div class="tree-node">${rel.character}
                                <div class="tree-relation">${rel.relation}</div>
                                <button class="btn btn-sm btn-danger admin-only" onclick="deleteRelationship('Kairo', '${rel.character}')"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        function generateRelationshipMap() {
            // This would generate a more complex relationship map showing all connections
            alert('Full relationship map generation would be implemented here');
        }
        
        // OC Management
        function approveOC(id) {
            const oc = sampleOCs.find(o => o.id === id);
            if (oc) {
                oc.status = 'approved';
                updateManageTable();
                showToast(`Approved ${oc.name}`);
            }
        }
        
        function deleteOC(id) {
            if (confirm('Are you sure you want to delete this OC? This action cannot be undone.')) {
                sampleOCs = sampleOCs.filter(o => o.id !== id);
                updateManageTable();
                showToast('OC deleted');
            }
        }
        
        function toggleSelectAll(checkbox) {
            const checkboxes = document.querySelectorAll('.oc-checkbox');
            checkboxes.forEach(cb => {
                cb.checked = checkbox.checked;
            });
        }
        
        function bulkDeleteOCs() {
            const selected = Array.from(document.querySelectorAll('.oc-checkbox:checked')).map(cb => parseInt(cb.dataset.id));
            
            if (selected.length === 0) {
                alert('Please select at least one OC to delete');
                return;
            }
            
            if (confirm(`Are you sure you want to delete ${selected.length} OC(s)? This action cannot be undone.`)) {
                sampleOCs = sampleOCs.filter(oc => !selected.includes(oc.id));
                updateManageTable();
                showToast(`Deleted ${selected.length} OC(s)`);
            }
        }
        
        function bulkApproveOCs() {
            const selected = Array.from(document.querySelectorAll('.oc-checkbox:checked')).map(cb => parseInt(cb.dataset.id));
            
            if (selected.length === 0) {
                alert('Please select at least one OC to approve');
                return;
            }
            
            sampleOCs.forEach(oc => {
                if (selected.includes(oc.id)) {
                    oc.status = 'approved';
                }
            });
            
            updateManageTable();
            showToast(`Approved ${selected.length} OC(s)`);
        }
        
        function updateManageTable() {
            const tableBody = document.getElementById('manageOcTable');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            sampleOCs.forEach(oc => {
                const row = document.createElement('tr');
                
                // Determine race class for coloring
                const raceClass = 'race-' + oc.race.toLowerCase().replace(' ', '-');
                
                row.innerHTML = `
                    <td><input type="checkbox" class="bulk-checkbox oc-checkbox" data-id="${oc.id}"></td>
                    <td>${oc.name}</td>
                    <td class="${raceClass}">${oc.race}</td>
                    <td>${oc.creator}</td>
                    <td>${oc.power.toLocaleString()}</td>
                    <td><span class="badge ${oc.status === 'approved' ? 'badge-success' : 'badge-warning'}">${oc.status === 'approved' ? 'Approved' : 'Pending'}</span></td>
                    <td>
                        ${oc.status !== 'approved' ? `<button class="btn btn-sm btn-success" onclick="approveOC(${oc.id})"><i class="fas fa-check"></i></button>` : ''}
                        <button class="btn btn-sm"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-danger" onclick="deleteOC(${oc.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Load saved data
        function loadSavedData() {
            // Load OC sheet state
            loadState();
            
            // Load timeline events
            const savedTimeline = localStorage.getItem(TIMELINE_KEY);
            if (savedTimeline) {
                timelineEvents = JSON.parse(savedTimeline);
                renderTimeline();
            }
            
            // Load relationships
            const savedRelationships = localStorage.getItem(RELATIONSHIPS_KEY);
            if (savedRelationships) {
                relationships = JSON.parse(savedRelationships);
                renderRelationshipTree();
            }
            
            // Set up poster upload
            const poster = document.getElementById('poster');
            const posterFile = document.getElementById('posterFile');
            
            poster.addEventListener('click', () => posterFile.click());
            
            posterFile.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        poster.style.backgroundImage = `url(${e.target.result})`;
                        updateImageViewer();
                        saveState();
                        
                        // Set up modal image viewer
                        document.getElementById('modalImage').src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Initial image viewer update
            updateImageViewer();
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // OC sheet inputs
            const ocInputs = document.querySelectorAll('#oc-sheet input, #oc-sheet textarea, #oc-sheet select');
            ocInputs.forEach(input => {
                input.addEventListener('input', saveState);
            });
            
            // Power input
            const powerInput = document.getElementById('powerInput');
            if (powerInput) {
                powerInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        readPower();
                        e.preventDefault();
                    }
                });
            }
            
            // Timeline form
            const timelineForm = document.getElementById('timelineEventForm');
            if (timelineForm) {
                timelineForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    saveTimelineEvent();
                });
            }
            
            // OC creation form
            const createOCForm = document.getElementById('createOCForm');
            if (createOCForm) {
                createOCForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    // Here you would create the new OC
                    hideModal('create-oc-modal');
                    showToast('New OC created');
                });
            }
            
            // Add event button
            const addEventBtn = document.getElementById('addEventBtn');
            if (addEventBtn) {
                addEventBtn.addEventListener('click', function() {
                    document.getElementById('eventDate').value = '';
                    document.getElementById('eventTitle').value = '';
                    document.getElementById('eventDescription').value = '';
                    document.getElementById('timelineModalTitle').textContent = 'Add Timeline Event';
                    delete document.getElementById('edit-timeline-modal').dataset.editIndex;
                });
            }
        }
        
        // Initialize with some sample entries
        function initializeSampleEntries() {
            // Add sample abilities if none exist
            if (document.getElementById('abilitiesList').children.length === 0) {
                addEntry('abilitiesList', 'generic', { name: 'Energy Sense', description: 'Can sense energy signatures across great distances', extra: 'Passive ability' });
            }
            
            // Add sample techniques if none exist
            if (document.getElementById('techniquesList').children.length === 0) {
                addEntry('techniquesList', 'generic', { name: 'Kamehameha', description: 'Classic energy wave attack', extra: 'Requires charging' });
            }
            
            // Add sample transformations if none exist
            if (document.getElementById('transformsList').children.length === 0) {
                addEntry('transformsList', 'transform', { name: 'Super Saiyan', description: 'Golden hair, increased power', extra: 'x50', glowColor: '#ffd700' });
            }
            
            // Add sample equipment if none exist
            if (document.getElementById('equipmentList').children.length === 0) {
                addEntry('equipmentList', 'generic', { name: 'Power Armor', description: 'Protective battle armor', extra: 'Scouter built-in' });
            }
        }
        
        // Initialize when page loads
        window.addEventListener('load', function() {
            initializeSampleEntries();
            
            // Set up tagline placeholder behavior
            const sheetTitle = document.getElementById('sheetTitle');
            const TAG_PLACEHOLDER = sheetTitle.dataset.placeholder || 'Character Quote / Tagline — (click to edit)';
            
            if (!sheetTitle.textContent.trim() || sheetTitle.textContent === TAG_PLACEHOLDER) {
                sheetTitle.textContent = TAG_PLACEHOLDER;
            }
            
            sheetTitle.addEventListener('focus', function() {
                if (this.textContent.trim() === TAG_PLACEHOLDER) {
                    this.textContent = '';
                }
            });
            
            sheetTitle.addEventListener('blur', function() {
                if (!this.textContent.trim()) {
                    this.textContent = TAG_PLACEHOLDER;
                }
                saveState();
            });
            
            sheetTitle.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    this.blur();
                }
            });
        });
        
        console.log('Dragon Ball RP Hub loaded with enhanced functionality');
    </script>
</body>
</html>